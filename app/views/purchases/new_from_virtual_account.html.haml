%h1
  == #{@virtual_account.name} 
  = "(#{@expected_purchase.recipe.name})" if @expected_purchase
%p== Virtual account balance: $#{@virtual_account.balance}

= form_for @purchase, :url => purchases_path do |pur|

  = pur.fields_for :virtual_purchases do |vt|
  
    %div.erase_all
      = vt.text_field :cents #, :type => :number, :step => '0.01', :min => '0.00', :placeholder => 'Amount'
      %span.erase_all X
    
    %div
      = pur.text_field :memo, :placeholder => 'Memo'
      
      = vt.hidden_field :account_from_id
      
    %div
      = pur.text_field :executed_at, :type => 'datetime'
      
    :javascript
      $(function() {
        var available_payees = #{@payees.map(&:name).to_json.html_safe};
        $('#purchase_vendor_name').autocomplete({
          source: available_payees
        });
        $('span.erase_all').bind('click', function() { $(this).parent().find('input').val('').focus(); });
        $('div.erase_all').hover(function() {  });
      });
      
    %div.erase_all
      = pur.text_field :vendor_name, :placeholder => 'Payee'
      %span.erase_all X

  %div
    = pur.select :account_from_id, @spending_accounts.map{ |a| [a.name, a.id] }, :selected => @virtual_account.primary_spending_account.id
  
  %label &nbsp;
  %br
  = pur.submit 'Submit'
  
:javascript
  $(function(){
    $('#physical_transaction_virtual_transactions_attributes_0_amount').mouseup(function() { $(this).select(); });
  });
:css
  body {
    font-family: Helvetica, Arial, sans-serif;
    font-size: 16px;
  }
  div.erase_all { position: relative; }
  div.erase_all span.erase_all { display: none; }
  div.erase_all:hover span.erase_all { display: block; }
  span.erase_all {
    position: absolute;
    top: 10px;
    right: 30px;
    cursor: pointer;
    width: 20px;
    height: 100%;
  }
  h1 {
    margin: 0;
    font-size: 1.2em;
  }
  p {
    margin: 0 0 1em 0;
  }
  label {
    font-weight: bold;
  }
  input, select {
    width: 90%;
    height: 1.4em;
    font-size: 1.4em;
    -webkit-appearance: none;
    -webkit-box-shadow: 1px 1px 1px #fff;
    -webkit-border-radius: 0.2em;
  }
  select {
    width: 97%;
    height: 1.8em;
    -webkit-appearance: none;
    -webkit-box-shadow: 1px 1px 1px #fff;
    -webkit-border-radius: 0.2em;
  }
